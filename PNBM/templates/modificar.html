<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamiento de Encuentro</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"> <!-- Agregamos Font Awesome -->
    <style>
        body {
            background: linear-gradient(90deg, #3498db, #2ecc71);
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-body">
                        <a href="#" onclick="history.go(-1);" class="btn btn-secondary mb-3"><i class="fas fa-arrow-left"></i> Volver</a>
                        <h2 class="card-title text-center">Agendamiento de Encuentro</h2>
                        <form>
                            <div class="form-group">
                                <label for="nombre">Nombre psicologo</label>
                                <input type="text" class="form-control" id="nombre" placeholder="Nombre" disabled autocomplete="additional-name">
                            </div>
                            <div class="form-group">
                                <label for="fecha">Fecha de Encuentro</label>
                                <input type="date" class="form-control" id="fecha" required>
                            </div>
                            <div class="form-group">
                                <label for="hora">Hora del Encuentro</label>
                                <input type="time" class="form-control" id="hora" required>
                            </div>
                            <div class="form-group">
                                <label for="jornada">Seleccione una Jornada</label>
                                <select class="form-control" id="jornada" name="jornada" disabled autocomplete="address-line2">
                                    <option value="manana">Jornada de la Mañana (6 AM - 12 PM)</option>
                                    <option value="tarde">Jornada de la Tarde (1 PM - 6 PM)</option>
                                    <option value="noche">Jornada de la Noche (7 PM - 10 PM)</option>
                                </select>
                            </div>
                            <input type="hidden" id="cita_id" name="cita_id" value="">
                            <button type="submit" id="agendarButton" class="btn btn-primary btn-block mt-3">Agendar Encuentro</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        const horaInput = document.getElementById('hora');
        
        horaInput.addEventListener('change', function() {
            const horaSeleccionada = horaInput.value;
            const horaActual = new Date(); // Obtener la hora actual
            const horaSeleccionadaSplit = horaSeleccionada.split(':');
            const horaSeleccionadaDate = new Date(horaActual.getFullYear(), horaActual.getMonth(), horaActual.getDate(), horaSeleccionadaSplit[0], horaSeleccionadaSplit[1]);
    
            const horaLimite = new Date(horaActual.getTime() + 60 * 60 * 1000); // Agregar 1 hora a la hora actual
    
            if (horaSeleccionadaDate > horaLimite) {
                alert('El encuentro no puede durar más de 1 hora. Por favor, elige un horario dentro de la hora límite.');
                horaInput.value = ''; // Limpiar el valor del campo si excede la duración
            }
            const fechaInput = document.getElementById('fecha');
        
            fechaInput.addEventListener('change', function() {
                const fechaSeleccionada = new Date(fechaInput.value);
                const fechaActual = new Date();
        
                // Comprueba si la fecha seleccionada es anterior a la fecha actual
                if (fechaSeleccionada < fechaActual) {
                    alert('No se puede seleccionar un día anterior al día actual.');
                    fechaInput.value = ''; // Limpia el valor del campo si es una fecha anterior
                }
    flatpickr("#hora", {
        enableTime: true,
        noCalendar: true,
        dateFormat: "H:i",
        time_24hr: true
    });
        const citaIdInput = document.getElementById("cita_id");
        const agendarButton = document.getElementById("agendarButton");
           
        // Función para habilitar la modificación de cita
        function habilitarModificacionCita(citaId) {
            citaIdInput.value = citaId;
            agendarButton.textContent = "Modificar Cita";
            // Aquí puedes realizar otras acciones necesarias para cargar los datos de la cita a modificar.
        }

        // Cuando se haga clic en el botón "Modificar Cita", llama a la función para habilitar la modificación.
        agendarButton.addEventListener("click", function() {
            if (citaIdInput.value) {
                // Realiza aquí las acciones para modificar la cita con el ID almacenado en citaIdInput.value.
            }
        });
    </script>
</body>
</html>